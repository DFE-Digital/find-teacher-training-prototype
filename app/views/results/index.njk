{% extends "_layouts/default.njk" %}

{% set title %}
  {% if resultsCount > 0 %}
    {{ resultsCount | numeral('0,0') }} course {{- "s" if resultsCount > 1 }} found
  {% else %}
    No courses found
  {% endif %}
{% endset %}

{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-xl">
        {{ title }}
      </h1>

    </div>
  </div>

  <div class="app-filter-layout">
    <div class="app-filter-layout__filter">

      {% include "./_filter-panel.njk" %}

    </div>

    <div class="app-filter-layout__content">

      {% include "./_promoted-link.njk" %}

      {% include "./_sort-options.njk" %}

      <div class="app-action-bar">
        <div class="app-action-bar__filter"></div>
      </div>

      {# {% include "./_search-panel.njk" %} #}

      {% if courses.length %}

        <ul class="app-search-results">
          {% for result in courses %}
            <li class="app-search-results__item">
              {% set isLocationSearch = (data.q != "england") %}
              {% set isUniversity = (result.provider.provider_type == "university") %}
              {% set trainingLocation = result.course.trainingLocation %}

              {{ appResultDetail({
                href: "/course/" + result.provider.code + "/" + result.course.code,
                providerName: result.provider.name | markdown("inline"),
                courseName: result.course.name + " (" + result.course.code + ")",
                schools: result.schools if not isUniversity and isLocationSearch,
                trainingLocation: {
                  distance: trainingLocation.distance,
                  address: trainingLocation.address
                } if trainingLocation and isUniversity and isLocationSearch,
                accreditedBody: result.course.accredited_body,
                studyType: result.course.study_mode | getStudyModeLabel,
                qualification: result.course.qualifications | getQualificationLabel,
                fundingOption: result.course.funding_option,
                degreeGrade: result.course.degree_grade,
                visaSponsorship: result.course.visaSponsorship,
                startDate: result.course.start_date,
                vacancies: "Yes" if result.course.has_vacancies else "No"
              }) }}
            </li>
          {% endfor %}
        </ul>

        {% if pagination %}
          {% include "./pagination.njk" %}
        {% endif %}

      {% else %}

        {% include "./_no-results.njk" %}

      {% endif %}

    </div>
  </div>
{% endblock %}
